{"version":3,"file":"static/js/494.5aa8d524.chunk.js","mappings":"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","sources":["pages/CompanyPage/CompanyPage.tsx"],"sourcesContent":["import React, {useEffect, useState, TouchEvent} from 'react';\r\nimport {useParams} from \"react-router-dom\";\r\n\r\nimport {ContactService} from \"../../services/ContactService\";\r\nimport {useAppContext} from \"../../context/AppContext\";\r\nimport {Container} from \"../../components/Container\";\r\nimport {Accordion} from \"../../components/Accordion\";\r\nimport {BXCompany} from \"../../classes/BXCompany\";\r\nimport {BXContact} from \"../../classes/BXContact\";\r\nimport {Title} from \"../../components/Title\";\r\nimport {Block} from \"../../components/Block\";\r\nimport {useTask} from \"../../hooks\";\r\n\r\nimport './CompanyPage.css'\r\n\r\nconst UNSET = 'Не указано'\r\n\r\n\r\nconst dateFormatter = new Intl.DateTimeFormat(\"ru-RU\", {\r\n    day: '2-digit',\r\n    month: '2-digit',\r\n    year: '2-digit',\r\n    hour: '2-digit',\r\n    minute: \"2-digit\",\r\n    second: \"2-digit\"\r\n})\r\n\r\n\r\nexport function CompanyPage() {\r\n    const s = useAppContext()\r\n    const {taskID, companyID} = useParams()\r\n    const task = useTask(taskID)\r\n    const [company, setCompany] = useState<BXCompany | undefined>()\r\n    const [contacts, setContacts] = useState<BXContact[]>([\r\n        // new BXContact({\r\n        //     NAME: 'Elena',\r\n        //     LAST_NAME: 'Astanina',\r\n        //     POST: 'zam ip decor',\r\n        //     PHONE: [\r\n        //         {ID: '1', VALUE: '1324569877', TYPE_ID: '', VALUE_TYPE: ''},\r\n        //         {ID: '2', VALUE: '3215487954', TYPE_ID: '', VALUE_TYPE: ''}\r\n        //     ]\r\n        // }),\r\n        // new BXContact({\r\n        //     NAME: 'asd',\r\n        //     LAST_NAME: 'asdasd',\r\n        //     POST: 'zam ip decor',\r\n        //     PHONE: [\r\n        //         {ID: '1', VALUE: '1324569877', TYPE_ID: '', VALUE_TYPE: ''},\r\n        //     ],\r\n        //     EMAIL: [\r\n        //         {ID: '1', VALUE: 'asd@asd.com', TYPE_ID: '', VALUE_TYPE: ''},\r\n        //     ]\r\n        // })\r\n    ])\r\n\r\n\r\n    useEffect(() => {\r\n        const t = s.tasks.find(t => t.id === taskID)\r\n        if (t) {\r\n            ContactService.getCompanies(s, t)\r\n                .then(cl => setCompany(cl.find(c => c.ID === companyID)))\r\n                .catch(console.error)\r\n        }\r\n    }, [taskID, companyID]);\r\n\r\n\r\n    useEffect(() => {\r\n        if(!task) return\r\n        ContactService.getContacts(s, task)\r\n            .then(setContacts)\r\n    }, [task]);\r\n\r\n\r\n    function handleWebLinkClick(e: TouchEvent<HTMLAnchorElement>){\r\n        e.preventDefault()\r\n        const el = e.target as HTMLAnchorElement\r\n        Telegram.WebApp.openLink(el.href)\r\n    }\r\n\r\n\r\n    function handlePhoneClick(e: TouchEvent<HTMLAnchorElement>, phone: BXContact['PHONE'][number]){\r\n        e.preventDefault()\r\n        navigator.clipboard.writeText(phone.VALUE)\r\n            .then(() => Telegram.WebApp.showAlert('номер телефона скопирован'))\r\n            .catch(console.error)\r\n    }\r\n\r\n\r\n    function handleEMailClick(e: TouchEvent<HTMLAnchorElement>, mail: BXContact['EMAIL'][number]){\r\n        e.preventDefault()\r\n        navigator.clipboard.writeText(mail.VALUE)\r\n            .then(() => Telegram.WebApp.showAlert('e-mail скопирован'))\r\n            .catch(console.error)\r\n    }\r\n\r\n\r\n\r\n    return (\r\n        <div className='wrapper'>\r\n            <div className='wrapper-header'>\r\n                <Title>{`Компания ${company ? '#' + company.ID : ''}`}</Title>\r\n            </div>\r\n            <div className='wrapper-content'>\r\n                <Container>\r\n                    <Block className=\"client client-container pd\">\r\n                        {!!company && (\r\n                            <>\r\n                                {/*<div className=\"client-field\">*/}\r\n                                {/*    <div className=\"client-field-descr\">Информация</div>*/}\r\n                                {/*    <div className=\"client-field-val\">{company.TITLE || UNSET}</div>*/}\r\n                                {/*</div>*/}\r\n                                <div className=\"client-field\">\r\n                                    <div className=\"client-field-descr\">Название компании</div>\r\n                                    <div className=\"client-field-val\">{company.TITLE || UNSET}</div>\r\n                                </div>\r\n                                <div className=\"client-field\">\r\n                                    <div className=\"client-field-descr\">Тип компании</div>\r\n                                    <div className=\"client-field-val\">{company.COMPANY_TYPE || UNSET}</div>\r\n                                </div>\r\n                                <div className=\"client-field\">\r\n                                    <div className=\"client-field-descr\">Телефон</div>\r\n                                    {company.PHONE.length\r\n                                        ? company.PHONE.map(p => (\r\n                                            <div className=\"client-field-val\">\r\n                                                <a\r\n                                                    className='client-phone'\r\n                                                    href={`tel:${p.VALUE}`}\r\n                                                onTouchEnd={e => handlePhoneClick(e, p)}>{p.VALUE}</a>\r\n                                            </div>\r\n                                        ))\r\n                                        : <div className=\"client-field-val\">{UNSET}</div>\r\n                                    }\r\n                                </div>\r\n                                <div className=\"client-field\">\r\n                                    <div className=\"client-field-descr\">E-mail</div>\r\n                                    <div className=\"client-field-val\">{company.EMAIL || UNSET}</div>\r\n                                </div>\r\n                                <div className=\"client-field\">\r\n                                    <div className=\"client-field-descr\">Город</div>\r\n                                    <div className=\"client-field-val\">{company.UF_CITY_LIST || UNSET}</div>\r\n                                </div>\r\n                                <div className=\"client-field\">\r\n                                    <div className=\"client-field-descr\">Адрес</div>\r\n                                    <div className=\"client-field-val\">\r\n                                        {company.ADDRESS}\r\n                                        {/*<span>{company.ADDRESS_CITY}</span><br/>*/}\r\n                                        {/*<span>{company.ADDRESS_COUNTRY}</span>*/}\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"client-field\">\r\n                                    <div className=\"client-field-descr\">Сайт</div>\r\n                                    {company.WEB.length > 0\r\n                                        ? company.WEB.map(w =>\r\n                                            <div key={w.ID} className=\"client-field-val\">\r\n                                                <a href={w.VALUE} onTouchEnd={handleWebLinkClick}>{w.VALUE}</a>\r\n                                            </div>\r\n                                        )\r\n                                        : <div className=\"client-field-val\">{UNSET}</div>\r\n                                    }\r\n                                </div>\r\n                                <div className=\"client-field\">\r\n                                    <div className=\"client-field-descr\">Комментарий</div>\r\n                                    <div className=\"client-field-val\">{company.COMMENTS || UNSET}</div>\r\n                                </div>\r\n                                <div className=\"client-field\">\r\n                                    <div className=\"client-field-descr\">Источник привлечения</div>\r\n                                    <div className=\"client-field-val\">{company.UF_SOURCE_IB || UNSET}</div>\r\n                                </div>\r\n                                <div className=\"client-field\">\r\n                                    <div className=\"client-field-descr\">Последняя коммуникация</div>\r\n                                    <div className=\"client-field-val\">\r\n                                        {company.UF_LAST_ACTIVITY ? dateFormatter.format(company.UF_LAST_ACTIVITY) : UNSET}\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"client-field\">\r\n                                    <div className=\"client-field-descr\">Дата создания в mawi</div>\r\n                                    <div className=\"client-field-val\">\r\n                                        {company.UF_EXT_DATE_CREATE ? dateFormatter.format(company.UF_EXT_DATE_CREATE) : UNSET}\r\n                                    </div>\r\n                                </div>\r\n                            </>\r\n                        )}\r\n                    </Block>\r\n\r\n                    {contacts.length > 0 &&\r\n                        <Block className='mt'>\r\n                            <Accordion title='Контакты'>\r\n                                <div className='company-contacts'>\r\n                                    {contacts.map(c => (\r\n                                        <div className='contact'>\r\n                                            <div className='contact-descr'>Контакты, связанные с компанией</div>\r\n                                            <div className='contact-name mb'>{`${c.LAST_NAME} ${c.NAME}`}</div>\r\n                                            {!!c.POST && <div className='contact-value'>{c.POST}</div>}\r\n                                            {c.PHONE.map(p =>\r\n                                                <div className='contact-value'>\r\n                                                    <a key={c.ID}\r\n                                                       className='contact-phone'\r\n                                                       href={`tel:${p.VALUE}`}\r\n                                                       onTouchEnd={e => handlePhoneClick(e, p)}>\r\n                                                        {p.VALUE}\r\n                                                    </a>\r\n                                                </div>\r\n                                            )}\r\n                                            {c.EMAIL.length > 0 && c.EMAIL.map(m =>\r\n                                                <div key={m.ID} className='contact-value'>\r\n                                                    <a href={`mailto:${m.VALUE}`} onTouchEnd={e => handleEMailClick(e, m)}>{m.VALUE}</a>\r\n                                                </div>\r\n                                            )}\r\n                                        </div>\r\n                                    ))}\r\n                                </div>\r\n                            </Accordion>\r\n                        </Block>\r\n                    }\r\n                </Container>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default CompanyPage"],"names":["UNSET","dateFormatter","Intl","DateTimeFormat","day","month","year","hour","minute","second","CompanyPage","s","useAppContext","taskID","companyID","useParams","task","useTask","company","setCompany","useState","contacts","setContacts","handleWebLinkClick","e","preventDefault","el","target","Telegram","WebApp","openLink","href","handlePhoneClick","phone","navigator","clipboard","writeText","VALUE","then","showAlert","catch","console","error","useEffect","t","tasks","find","id","ContactService","getCompanies","cl","c","ID","getContacts","_jsxs","className","children","_jsx","Title","Container","Block","_Fragment","TITLE","COMPANY_TYPE","PHONE","length","map","p","onTouchEnd","EMAIL","UF_CITY_LIST","ADDRESS","WEB","w","COMMENTS","UF_SOURCE_IB","UF_LAST_ACTIVITY","format","UF_EXT_DATE_CREATE","Accordion","title","LAST_NAME","NAME","POST","m","mail","handleEMailClick"],"sourceRoot":""}